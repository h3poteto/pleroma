webpackJsonp([70],{488:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"findElementPosition",function(){return E}),n.d(t,"getPointerPosition",function(){return L}),n.d(t,"default",function(){return k});var a,o=n(1),i=n.n(o),s=n(2),d=n.n(s),l=n(3),r=n.n(l),u=n(4),c=n.n(u),v=n(165),h=n.n(v),f=n(0),p=n.n(f),m=n(7),g=n(6),M=(n.n(g),n(10)),y=n.n(M),b=n(592),_=n(53),w=Object(m.f)({play:{id:"video.play",defaultMessage:"Play"},pause:{id:"video.pause",defaultMessage:"Pause"},mute:{id:"video.mute",defaultMessage:"Mute sound"},unmute:{id:"video.unmute",defaultMessage:"Unmute sound"},hide:{id:"video.hide",defaultMessage:"Hide video"},expand:{id:"video.expand",defaultMessage:"Expand video"},close:{id:"video.close",defaultMessage:"Close video"},fullscreen:{id:"video.fullscreen",defaultMessage:"Full screen"},exit_fullscreen:{id:"video.exit_fullscreen",defaultMessage:"Exit full screen"}}),C=function(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),a=e-3600*t-60*n;return t<10&&(t="0"+t),n<10&&(n="0"+n),a<10&&(a="0"+a),("00"===t?"":t+":")+n+":"+a},E=function(e){var t=void 0;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var n=document.documentElement,a=document.body,o=n.clientLeft||a.clientLeft||0,i=window.pageXOffset||a.scrollLeft,s=t.left+i-o,d=n.clientTop||a.clientTop||0,l=window.pageYOffset||a.scrollTop,r=t.top+l-d;return{left:Math.round(s),top:Math.round(r)}},L=function(e,t){var n={},a=E(e),o=e.offsetWidth,i=e.offsetHeight,s=a.top,d=a.left,l=t.pageY,r=t.pageX;return t.changedTouches&&(r=t.changedTouches[0].pageX,l=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(l-s)/i)),n.x=Math.max(0,Math.min(1,(r-d)/o)),n},k=Object(m.g)(a=function(e){function t(){var n,a,o;d()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return n=a=r()(this,e.call.apply(e,[this].concat(s))),a.state={currentTime:0,duration:0,paused:!0,dragging:!1,containerWidth:!1,fullscreen:!1,hovered:!1,muted:!1,revealed:void 0===a.props.revealed?!a.props.sensitive||_.e:a.props.revealed},a.setPlayerRef=function(e){a.player=e,e&&a.setState({containerWidth:e.offsetWidth})},a.setVideoRef=function(e){a.video=e},a.setSeekRef=function(e){a.seek=e},a.handleClickRoot=function(e){return e.stopPropagation()},a.handlePlay=function(){a.setState({paused:!1})},a.handlePause=function(){a.setState({paused:!0})},a.handleTimeUpdate=function(){a.setState({currentTime:Math.floor(a.video.currentTime),duration:Math.floor(a.video.duration)})},a.handleMouseDown=function(e){document.addEventListener("mousemove",a.handleMouseMove,!0),document.addEventListener("mouseup",a.handleMouseUp,!0),document.addEventListener("touchmove",a.handleMouseMove,!0),document.addEventListener("touchend",a.handleMouseUp,!0),a.setState({dragging:!0}),a.video.pause(),a.handleMouseMove(e)},a.handleMouseUp=function(){document.removeEventListener("mousemove",a.handleMouseMove,!0),document.removeEventListener("mouseup",a.handleMouseUp,!0),document.removeEventListener("touchmove",a.handleMouseMove,!0),document.removeEventListener("touchend",a.handleMouseUp,!0),a.setState({dragging:!1}),a.video.play()},a.handleMouseMove=h()(function(e){var t=L(a.seek,e),n=t.x,o=Math.floor(a.video.duration*n);a.video.currentTime=o,a.setState({currentTime:o})},60),a.togglePlay=function(){a.state.paused?a.video.play():a.video.pause()},a.toggleFullscreen=function(){Object(b.d)()?Object(b.c)():Object(b.e)(a.player)},a.handleFullscreenChange=function(){a.setState({fullscreen:Object(b.d)()})},a.handleMouseEnter=function(){a.setState({hovered:!0})},a.handleMouseLeave=function(){a.setState({hovered:!1})},a.toggleMute=function(){a.video.muted=!a.video.muted,a.setState({muted:a.video.muted})},a.toggleReveal=function(){a.state.revealed&&a.video.pause(),a.setState({revealed:!a.state.revealed})},a.handleLoadedData=function(){a.props.startTime&&(a.video.currentTime=a.props.startTime,a.video.play())},a.handleProgress=function(){a.video.buffered.length>0&&a.setState({buffer:a.video.buffered.end(0)/a.video.duration*100})},a.handleOpenVideo=function(){var e=a.props,t=e.src,n=e.preview,o=e.width,i=e.height,s=Object(g.fromJS)({type:"video",url:t,preview_url:n,width:o,height:i});a.video.pause(),a.props.onOpenVideo(s,a.video.currentTime)},a.handleCloseVideo=function(){a.video.pause(),a.props.onCloseVideo()},o=n,r()(a,o)}return c()(t,e),t.prototype.componentDidMount=function(){document.addEventListener("fullscreenchange",this.handleFullscreenChange,!0),document.addEventListener("webkitfullscreenchange",this.handleFullscreenChange,!0),document.addEventListener("mozfullscreenchange",this.handleFullscreenChange,!0),document.addEventListener("MSFullscreenChange",this.handleFullscreenChange,!0)},t.prototype.componentWillUnmount=function(){document.removeEventListener("fullscreenchange",this.handleFullscreenChange,!0),document.removeEventListener("webkitfullscreenchange",this.handleFullscreenChange,!0),document.removeEventListener("mozfullscreenchange",this.handleFullscreenChange,!0),document.removeEventListener("MSFullscreenChange",this.handleFullscreenChange,!0)},t.prototype.render=function(){var e=this.props,t=e.preview,n=e.src,a=e.inline,o=e.startTime,s=e.onOpenVideo,d=e.onCloseVideo,l=e.intl,r=e.alt,u=e.letterbox,c=e.fullwidth,v=e.detailed,h=e.sensitive,f=this.state,g=f.containerWidth,M=f.currentTime,b=f.duration,_=f.buffer,E=f.dragging,L=f.paused,k=f.fullscreen,N=f.hovered,P=f.muted,T=f.revealed,S=M/b*100,x={},F=this.props,O=F.width,R=F.height;a&&g&&(O=g,R=g/(16/9),x.width=O,x.height=R);var U=void 0;return U=h?i()(m.b,{id:"status.sensitive_warning",defaultMessage:"Sensitive content"}):i()(m.b,{id:"status.media_hidden",defaultMessage:"Media hidden"}),p.a.createElement("div",{className:y()("video-player",{inactive:!T,detailed:v,inline:a&&!k,fullscreen:k,letterbox:u,"full-width":c}),style:x,ref:this.setPlayerRef,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClickRoot,tabIndex:0},p.a.createElement("video",{ref:this.setVideoRef,src:n,poster:t,preload:o?"auto":"none",loop:!0,role:"button",tabIndex:"0","aria-label":r,width:O,height:R,onClick:this.togglePlay,onPlay:this.handlePlay,onPause:this.handlePause,onTimeUpdate:this.handleTimeUpdate,onLoadedData:this.handleLoadedData,onProgress:this.handleProgress}),i()("button",{type:"button",className:y()("video-player__spoiler",{active:!T}),onClick:this.toggleReveal},void 0,i()("span",{className:"video-player__spoiler__title"},void 0,U),i()("span",{className:"video-player__spoiler__subtitle"},void 0,i()(m.b,{id:"status.sensitive_toggle",defaultMessage:"Click to view"}))),i()("div",{className:y()("video-player__controls",{active:L||N})},void 0,p.a.createElement("div",{className:"video-player__seek",onMouseDown:this.handleMouseDown,ref:this.setSeekRef},i()("div",{className:"video-player__seek__buffer",style:{width:_+"%"}}),i()("div",{className:"video-player__seek__progress",style:{width:S+"%"}}),i()("span",{className:y()("video-player__seek__handle",{active:E}),tabIndex:"0",style:{left:S+"%"}})),i()("div",{className:"video-player__buttons-bar"},void 0,i()("div",{className:"video-player__buttons left"},void 0,i()("button",{type:"button","aria-label":l.formatMessage(L?w.play:w.pause),onClick:this.togglePlay},void 0,i()("i",{className:y()("fa fa-fw",{"fa-play":L,"fa-pause":!L})})),i()("button",{type:"button","aria-label":l.formatMessage(P?w.unmute:w.mute),onClick:this.toggleMute},void 0,i()("i",{className:y()("fa fa-fw",{"fa-volume-off":P,"fa-volume-up":!P})})),!d&&i()("button",{type:"button","aria-label":l.formatMessage(w.hide),onClick:this.toggleReveal},void 0,i()("i",{className:"fa fa-fw fa-eye"})),(v||k)&&i()("span",{},void 0,i()("span",{className:"video-player__time-current"},void 0,C(M)),i()("span",{className:"video-player__time-sep"},void 0,"/"),i()("span",{className:"video-player__time-total"},void 0,C(b)))),i()("div",{className:"video-player__buttons right"},void 0,!k&&s&&i()("button",{type:"button","aria-label":l.formatMessage(w.expand),onClick:this.handleOpenVideo},void 0,i()("i",{className:"fa fa-fw fa-expand"})),d&&i()("button",{type:"button","aria-label":l.formatMessage(w.close),onClick:this.handleCloseVideo},void 0,i()("i",{className:"fa fa-fw fa-compress"})),i()("button",{type:"button","aria-label":l.formatMessage(k?w.exit_fullscreen:w.fullscreen),onClick:this.toggleFullscreen},void 0,i()("i",{className:y()("fa fa-fw",{"fa-arrows-alt":!k,"fa-compress":k})}))))))},t}(p.a.PureComponent))||a}});
//# sourceMappingURL=video.js.map