{"version":3,"sources":["webpack:///flavours/glitch/async/video.js","webpack:///app/javascript/mnt/gentoo/home/haelwenn/Sources/git/hacktivis.me/git/mastofe/app/javascript/flavours/glitch/features/video/index.js"],"names":["webpackJsonp","488","module","__webpack_exports__","__webpack_require__","Object","defineProperty","value","d","findElementPosition","getPointerPosition","Video","_class","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default","__WEBPACK_IMPORTED_MODULE_4_lodash_throttle__","__WEBPACK_IMPORTED_MODULE_4_lodash_throttle___default","__WEBPACK_IMPORTED_MODULE_5_react__","__WEBPACK_IMPORTED_MODULE_5_react___default","__WEBPACK_IMPORTED_MODULE_6_react_intl__","__WEBPACK_IMPORTED_MODULE_7_immutable__","__WEBPACK_IMPORTED_MODULE_8_classnames__","__WEBPACK_IMPORTED_MODULE_8_classnames___default","__WEBPACK_IMPORTED_MODULE_9_flavours_glitch_util_fullscreen__","__WEBPACK_IMPORTED_MODULE_10_flavours_glitch_util_initial_state__","messages","play","id","defaultMessage","pause","mute","unmute","hide","expand","close","fullscreen","exit_fullscreen","formatTime","secondsNum","hours","Math","floor","minutes","seconds","el","box","getBoundingClientRect","parentNode","left","top","docEl","document","documentElement","body","clientLeft","scrollLeft","window","pageXOffset","clientTop","scrollTop","pageYOffset","round","event","position","boxW","offsetWidth","boxH","offsetHeight","boxY","boxX","pageY","pageX","changedTouches","y","max","min","x","_React$PureComponent","_temp","_this","_ret","this","_len","arguments","length","args","Array","_key","call","apply","concat","state","currentTime","duration","paused","dragging","containerWidth","hovered","muted","revealed","undefined","props","sensitive","setPlayerRef","c","player","setState","setVideoRef","video","setSeekRef","seek","handleClickRoot","e","stopPropagation","handlePlay","handlePause","handleTimeUpdate","handleMouseDown","addEventListener","handleMouseMove","handleMouseUp","removeEventListener","_getPointerPosition","togglePlay","toggleFullscreen","handleFullscreenChange","handleMouseEnter","handleMouseLeave","toggleMute","toggleReveal","handleLoadedData","startTime","handleProgress","buffered","buffer","end","handleOpenVideo","_this$props","src","preview","width","height","media","type","url","preview_url","onOpenVideo","handleCloseVideo","onCloseVideo","prototype","componentDidMount","componentWillUnmount","render","_props","inline","intl","alt","letterbox","fullwidth","detailed","_state","progress","playerStyle","_props2","warning","a","createElement","className","inactive","full-width","style","ref","onMouseEnter","onMouseLeave","onClick","tabIndex","poster","preload","loop","role","aria-label","onPlay","onPause","onTimeUpdate","onLoadedData","onProgress","active","onMouseDown","formatMessage","fa-play","fa-pause","fa-volume-off","fa-volume-up","fa-arrows-alt","fa-compress","PureComponent"],"mappings":"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","file":"flavours/glitch/async/video.js","sourcesContent":["webpackJsonp([70],{\n\n/***/ 488:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findElementPosition\", function() { return findElementPosition; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPointerPosition\", function() { return getPointerPosition; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Video; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_throttle__ = __webpack_require__(165);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_throttle___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_lodash_throttle__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_react_intl__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_immutable__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_immutable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_immutable__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_classnames__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_classnames___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_classnames__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_flavours_glitch_util_fullscreen__ = __webpack_require__(592);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_flavours_glitch_util_initial_state__ = __webpack_require__(53);\n\n\n\n\n\n\nvar _class;\n\n\n\n\n\n\n\n\n\n\nvar messages = Object(__WEBPACK_IMPORTED_MODULE_6_react_intl__[\"f\" /* defineMessages */])({\n  play: {\n    'id': 'video.play',\n    'defaultMessage': 'Play'\n  },\n  pause: {\n    'id': 'video.pause',\n    'defaultMessage': 'Pause'\n  },\n  mute: {\n    'id': 'video.mute',\n    'defaultMessage': 'Mute sound'\n  },\n  unmute: {\n    'id': 'video.unmute',\n    'defaultMessage': 'Unmute sound'\n  },\n  hide: {\n    'id': 'video.hide',\n    'defaultMessage': 'Hide video'\n  },\n  expand: {\n    'id': 'video.expand',\n    'defaultMessage': 'Expand video'\n  },\n  close: {\n    'id': 'video.close',\n    'defaultMessage': 'Close video'\n  },\n  fullscreen: {\n    'id': 'video.fullscreen',\n    'defaultMessage': 'Full screen'\n  },\n  exit_fullscreen: {\n    'id': 'video.exit_fullscreen',\n    'defaultMessage': 'Exit full screen'\n  }\n});\n\nvar formatTime = function formatTime(secondsNum) {\n  var hours = Math.floor(secondsNum / 3600);\n  var minutes = Math.floor((secondsNum - hours * 3600) / 60);\n  var seconds = secondsNum - hours * 3600 - minutes * 60;\n\n  if (hours < 10) hours = '0' + hours;\n  if (minutes < 10) minutes = '0' + minutes;\n  if (seconds < 10) seconds = '0' + seconds;\n  return (hours === '00' ? '' : hours + ':') + (minutes + ':' + seconds);\n};\n\nvar findElementPosition = function findElementPosition(el) {\n  var box = void 0;\n\n  if (el.getBoundingClientRect && el.parentNode) {\n    box = el.getBoundingClientRect();\n  }\n\n  if (!box) {\n    return {\n      left: 0,\n      top: 0\n    };\n  }\n\n  var docEl = document.documentElement;\n  var body = document.body;\n\n  var clientLeft = docEl.clientLeft || body.clientLeft || 0;\n  var scrollLeft = window.pageXOffset || body.scrollLeft;\n  var left = box.left + scrollLeft - clientLeft;\n\n  var clientTop = docEl.clientTop || body.clientTop || 0;\n  var scrollTop = window.pageYOffset || body.scrollTop;\n  var top = box.top + scrollTop - clientTop;\n\n  return {\n    left: Math.round(left),\n    top: Math.round(top)\n  };\n};\n\nvar getPointerPosition = function getPointerPosition(el, event) {\n  var position = {};\n  var box = findElementPosition(el);\n  var boxW = el.offsetWidth;\n  var boxH = el.offsetHeight;\n  var boxY = box.top;\n  var boxX = box.left;\n\n  var pageY = event.pageY;\n  var pageX = event.pageX;\n\n  if (event.changedTouches) {\n    pageX = event.changedTouches[0].pageX;\n    pageY = event.changedTouches[0].pageY;\n  }\n\n  position.y = Math.max(0, Math.min(1, (pageY - boxY) / boxH));\n  position.x = Math.max(0, Math.min(1, (pageX - boxX) / boxW));\n\n  return position;\n};\n\nvar Video = Object(__WEBPACK_IMPORTED_MODULE_6_react_intl__[\"g\" /* injectIntl */])(_class = function (_React$PureComponent) {\n  __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default()(Video, _React$PureComponent);\n\n  function Video() {\n    var _temp, _this, _ret;\n\n    __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default()(this, Video);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default()(this, _React$PureComponent.call.apply(_React$PureComponent, [this].concat(args))), _this), _this.state = {\n      currentTime: 0,\n      duration: 0,\n      paused: true,\n      dragging: false,\n      containerWidth: false,\n      fullscreen: false,\n      hovered: false,\n      muted: false,\n      revealed: _this.props.revealed === undefined ? !_this.props.sensitive || __WEBPACK_IMPORTED_MODULE_10_flavours_glitch_util_initial_state__[\"e\" /* displaySensitiveMedia */] : _this.props.revealed\n    }, _this.setPlayerRef = function (c) {\n      _this.player = c;\n\n      if (c) {\n        _this.setState({\n          containerWidth: c.offsetWidth\n        });\n      }\n    }, _this.setVideoRef = function (c) {\n      _this.video = c;\n    }, _this.setSeekRef = function (c) {\n      _this.seek = c;\n    }, _this.handleClickRoot = function (e) {\n      return e.stopPropagation();\n    }, _this.handlePlay = function () {\n      _this.setState({ paused: false });\n    }, _this.handlePause = function () {\n      _this.setState({ paused: true });\n    }, _this.handleTimeUpdate = function () {\n      _this.setState({\n        currentTime: Math.floor(_this.video.currentTime),\n        duration: Math.floor(_this.video.duration)\n      });\n    }, _this.handleMouseDown = function (e) {\n      document.addEventListener('mousemove', _this.handleMouseMove, true);\n      document.addEventListener('mouseup', _this.handleMouseUp, true);\n      document.addEventListener('touchmove', _this.handleMouseMove, true);\n      document.addEventListener('touchend', _this.handleMouseUp, true);\n\n      _this.setState({ dragging: true });\n      _this.video.pause();\n      _this.handleMouseMove(e);\n    }, _this.handleMouseUp = function () {\n      document.removeEventListener('mousemove', _this.handleMouseMove, true);\n      document.removeEventListener('mouseup', _this.handleMouseUp, true);\n      document.removeEventListener('touchmove', _this.handleMouseMove, true);\n      document.removeEventListener('touchend', _this.handleMouseUp, true);\n\n      _this.setState({ dragging: false });\n      _this.video.play();\n    }, _this.handleMouseMove = __WEBPACK_IMPORTED_MODULE_4_lodash_throttle___default()(function (e) {\n      var _getPointerPosition = getPointerPosition(_this.seek, e),\n          x = _getPointerPosition.x;\n\n      var currentTime = Math.floor(_this.video.duration * x);\n\n      _this.video.currentTime = currentTime;\n      _this.setState({ currentTime: currentTime });\n    }, 60), _this.togglePlay = function () {\n      if (_this.state.paused) {\n        _this.video.play();\n      } else {\n        _this.video.pause();\n      }\n    }, _this.toggleFullscreen = function () {\n      if (Object(__WEBPACK_IMPORTED_MODULE_9_flavours_glitch_util_fullscreen__[\"d\" /* isFullscreen */])()) {\n        Object(__WEBPACK_IMPORTED_MODULE_9_flavours_glitch_util_fullscreen__[\"c\" /* exitFullscreen */])();\n      } else {\n        Object(__WEBPACK_IMPORTED_MODULE_9_flavours_glitch_util_fullscreen__[\"e\" /* requestFullscreen */])(_this.player);\n      }\n    }, _this.handleFullscreenChange = function () {\n      _this.setState({ fullscreen: Object(__WEBPACK_IMPORTED_MODULE_9_flavours_glitch_util_fullscreen__[\"d\" /* isFullscreen */])() });\n    }, _this.handleMouseEnter = function () {\n      _this.setState({ hovered: true });\n    }, _this.handleMouseLeave = function () {\n      _this.setState({ hovered: false });\n    }, _this.toggleMute = function () {\n      _this.video.muted = !_this.video.muted;\n      _this.setState({ muted: _this.video.muted });\n    }, _this.toggleReveal = function () {\n      if (_this.state.revealed) {\n        _this.video.pause();\n      }\n\n      _this.setState({ revealed: !_this.state.revealed });\n    }, _this.handleLoadedData = function () {\n      if (_this.props.startTime) {\n        _this.video.currentTime = _this.props.startTime;\n        _this.video.play();\n      }\n    }, _this.handleProgress = function () {\n      if (_this.video.buffered.length > 0) {\n        _this.setState({ buffer: _this.video.buffered.end(0) / _this.video.duration * 100 });\n      }\n    }, _this.handleOpenVideo = function () {\n      var _this$props = _this.props,\n          src = _this$props.src,\n          preview = _this$props.preview,\n          width = _this$props.width,\n          height = _this$props.height;\n\n      var media = Object(__WEBPACK_IMPORTED_MODULE_7_immutable__[\"fromJS\"])({\n        type: 'video',\n        url: src,\n        preview_url: preview,\n        width: width,\n        height: height\n      });\n\n      _this.video.pause();\n      _this.props.onOpenVideo(media, _this.video.currentTime);\n    }, _this.handleCloseVideo = function () {\n      _this.video.pause();\n      _this.props.onCloseVideo();\n    }, _temp), __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default()(_this, _ret);\n  }\n\n  Video.prototype.componentDidMount = function componentDidMount() {\n    document.addEventListener('fullscreenchange', this.handleFullscreenChange, true);\n    document.addEventListener('webkitfullscreenchange', this.handleFullscreenChange, true);\n    document.addEventListener('mozfullscreenchange', this.handleFullscreenChange, true);\n    document.addEventListener('MSFullscreenChange', this.handleFullscreenChange, true);\n  };\n\n  Video.prototype.componentWillUnmount = function componentWillUnmount() {\n    document.removeEventListener('fullscreenchange', this.handleFullscreenChange, true);\n    document.removeEventListener('webkitfullscreenchange', this.handleFullscreenChange, true);\n    document.removeEventListener('mozfullscreenchange', this.handleFullscreenChange, true);\n    document.removeEventListener('MSFullscreenChange', this.handleFullscreenChange, true);\n  };\n\n  Video.prototype.render = function render() {\n    var _props = this.props,\n        preview = _props.preview,\n        src = _props.src,\n        inline = _props.inline,\n        startTime = _props.startTime,\n        onOpenVideo = _props.onOpenVideo,\n        onCloseVideo = _props.onCloseVideo,\n        intl = _props.intl,\n        alt = _props.alt,\n        letterbox = _props.letterbox,\n        fullwidth = _props.fullwidth,\n        detailed = _props.detailed,\n        sensitive = _props.sensitive;\n    var _state = this.state,\n        containerWidth = _state.containerWidth,\n        currentTime = _state.currentTime,\n        duration = _state.duration,\n        buffer = _state.buffer,\n        dragging = _state.dragging,\n        paused = _state.paused,\n        fullscreen = _state.fullscreen,\n        hovered = _state.hovered,\n        muted = _state.muted,\n        revealed = _state.revealed;\n\n    var progress = currentTime / duration * 100;\n    var playerStyle = {};\n\n    var _props2 = this.props,\n        width = _props2.width,\n        height = _props2.height;\n\n\n    if (inline && containerWidth) {\n      width = containerWidth;\n      height = containerWidth / (16 / 9);\n\n      playerStyle.width = width;\n      playerStyle.height = height;\n    }\n\n    var warning = void 0;\n    if (sensitive) {\n      warning = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_6_react_intl__[\"b\" /* FormattedMessage */], {\n        id: 'status.sensitive_warning',\n        defaultMessage: 'Sensitive content'\n      });\n    } else {\n      warning = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_6_react_intl__[\"b\" /* FormattedMessage */], {\n        id: 'status.media_hidden',\n        defaultMessage: 'Media hidden'\n      });\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(\n      'div',\n      {\n        className: __WEBPACK_IMPORTED_MODULE_8_classnames___default()('video-player', { inactive: !revealed, detailed: detailed, inline: inline && !fullscreen, fullscreen: fullscreen, letterbox: letterbox, 'full-width': fullwidth }),\n        style: playerStyle,\n        ref: this.setPlayerRef,\n        onMouseEnter: this.handleMouseEnter,\n        onMouseLeave: this.handleMouseLeave,\n        onClick: this.handleClickRoot,\n        tabIndex: 0\n      },\n      __WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement('video', {\n        ref: this.setVideoRef,\n        src: src,\n        poster: preview,\n        preload: startTime ? 'auto' : 'none',\n        loop: true,\n        role: 'button',\n        tabIndex: '0',\n        'aria-label': alt,\n        width: width,\n        height: height,\n        onClick: this.togglePlay,\n        onPlay: this.handlePlay,\n        onPause: this.handlePause,\n        onTimeUpdate: this.handleTimeUpdate,\n        onLoadedData: this.handleLoadedData,\n        onProgress: this.handleProgress\n      }),\n      __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n        type: 'button',\n        className: __WEBPACK_IMPORTED_MODULE_8_classnames___default()('video-player__spoiler', { active: !revealed }),\n        onClick: this.toggleReveal\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n        className: 'video-player__spoiler__title'\n      }, void 0, warning), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n        className: 'video-player__spoiler__subtitle'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_6_react_intl__[\"b\" /* FormattedMessage */], {\n        id: 'status.sensitive_toggle',\n        defaultMessage: 'Click to view'\n      }))),\n      __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: __WEBPACK_IMPORTED_MODULE_8_classnames___default()('video-player__controls', { active: paused || hovered })\n      }, void 0, __WEBPACK_IMPORTED_MODULE_5_react___default.a.createElement(\n        'div',\n        { className: 'video-player__seek', onMouseDown: this.handleMouseDown, ref: this.setSeekRef },\n        __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n          className: 'video-player__seek__buffer',\n          style: { width: buffer + '%' }\n        }),\n        __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n          className: 'video-player__seek__progress',\n          style: { width: progress + '%' }\n        }),\n        __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n          className: __WEBPACK_IMPORTED_MODULE_8_classnames___default()('video-player__seek__handle', { active: dragging }),\n          tabIndex: '0',\n          style: { left: progress + '%' }\n        })\n      ), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: 'video-player__buttons-bar'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: 'video-player__buttons left'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n        type: 'button',\n        'aria-label': intl.formatMessage(paused ? messages.play : messages.pause),\n        onClick: this.togglePlay\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('i', {\n        className: __WEBPACK_IMPORTED_MODULE_8_classnames___default()('fa fa-fw', { 'fa-play': paused, 'fa-pause': !paused })\n      })), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n        type: 'button',\n        'aria-label': intl.formatMessage(muted ? messages.unmute : messages.mute),\n        onClick: this.toggleMute\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('i', {\n        className: __WEBPACK_IMPORTED_MODULE_8_classnames___default()('fa fa-fw', { 'fa-volume-off': muted, 'fa-volume-up': !muted })\n      })), !onCloseVideo && __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n        type: 'button',\n        'aria-label': intl.formatMessage(messages.hide),\n        onClick: this.toggleReveal\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('i', {\n        className: 'fa fa-fw fa-eye'\n      })), (detailed || fullscreen) && __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {}, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n        className: 'video-player__time-current'\n      }, void 0, formatTime(currentTime)), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n        className: 'video-player__time-sep'\n      }, void 0, '/'), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n        className: 'video-player__time-total'\n      }, void 0, formatTime(duration)))), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: 'video-player__buttons right'\n      }, void 0, !fullscreen && onOpenVideo && __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n        type: 'button',\n        'aria-label': intl.formatMessage(messages.expand),\n        onClick: this.handleOpenVideo\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('i', {\n        className: 'fa fa-fw fa-expand'\n      })), onCloseVideo && __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n        type: 'button',\n        'aria-label': intl.formatMessage(messages.close),\n        onClick: this.handleCloseVideo\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('i', {\n        className: 'fa fa-fw fa-compress'\n      })), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n        type: 'button',\n        'aria-label': intl.formatMessage(fullscreen ? messages.exit_fullscreen : messages.fullscreen),\n        onClick: this.toggleFullscreen\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('i', {\n        className: __WEBPACK_IMPORTED_MODULE_8_classnames___default()('fa fa-fw', { 'fa-arrows-alt': !fullscreen, 'fa-compress': fullscreen })\n      })))))\n    );\n  };\n\n  return Video;\n}(__WEBPACK_IMPORTED_MODULE_5_react___default.a.PureComponent)) || _class;\n\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// flavours/glitch/async/video.js","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { defineMessages, injectIntl, FormattedMessage } from 'react-intl';\nimport { fromJS } from 'immutable';\nimport { throttle } from 'lodash';\nimport classNames from 'classnames';\nimport { isFullscreen, requestFullscreen, exitFullscreen } from 'flavours/glitch/util/fullscreen';\nimport { displaySensitiveMedia } from 'flavours/glitch/util/initial_state';\n\nconst messages = defineMessages({\n  play: { id: 'video.play', defaultMessage: 'Play' },\n  pause: { id: 'video.pause', defaultMessage: 'Pause' },\n  mute: { id: 'video.mute', defaultMessage: 'Mute sound' },\n  unmute: { id: 'video.unmute', defaultMessage: 'Unmute sound' },\n  hide: { id: 'video.hide', defaultMessage: 'Hide video' },\n  expand: { id: 'video.expand', defaultMessage: 'Expand video' },\n  close: { id: 'video.close', defaultMessage: 'Close video' },\n  fullscreen: { id: 'video.fullscreen', defaultMessage: 'Full screen' },\n  exit_fullscreen: { id: 'video.exit_fullscreen', defaultMessage: 'Exit full screen' },\n});\n\nconst formatTime = secondsNum => {\n  let hours   = Math.floor(secondsNum / 3600);\n  let minutes = Math.floor((secondsNum - (hours * 3600)) / 60);\n  let seconds = secondsNum - (hours * 3600) - (minutes * 60);\n\n  if (hours   < 10) hours   = '0' + hours;\n  if (minutes < 10) minutes = '0' + minutes;\n  if (seconds < 10) seconds = '0' + seconds;\n  return (hours === '00' ? '' : `${hours}:`) + `${minutes}:${seconds}`;\n};\n\nexport const findElementPosition = el => {\n  let box;\n\n  if (el.getBoundingClientRect && el.parentNode) {\n    box = el.getBoundingClientRect();\n  }\n\n  if (!box) {\n    return {\n      left: 0,\n      top: 0,\n    };\n  }\n\n  const docEl = document.documentElement;\n  const body  = document.body;\n\n  const clientLeft = docEl.clientLeft || body.clientLeft || 0;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n  const left       = (box.left + scrollLeft) - clientLeft;\n\n  const clientTop = docEl.clientTop || body.clientTop || 0;\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const top       = (box.top + scrollTop) - clientTop;\n\n  return {\n    left: Math.round(left),\n    top: Math.round(top),\n  };\n};\n\nexport const getPointerPosition = (el, event) => {\n  const position = {};\n  const box = findElementPosition(el);\n  const boxW = el.offsetWidth;\n  const boxH = el.offsetHeight;\n  const boxY = box.top;\n  const boxX = box.left;\n\n  let pageY = event.pageY;\n  let pageX = event.pageX;\n\n  if (event.changedTouches) {\n    pageX = event.changedTouches[0].pageX;\n    pageY = event.changedTouches[0].pageY;\n  }\n\n  position.y = Math.max(0, Math.min(1, (pageY - boxY) / boxH));\n  position.x = Math.max(0, Math.min(1, (pageX - boxX) / boxW));\n\n  return position;\n};\n\n@injectIntl\nexport default class Video extends React.PureComponent {\n\n  static propTypes = {\n    preview: PropTypes.string,\n    src: PropTypes.string.isRequired,\n    alt: PropTypes.string,\n    width: PropTypes.number,\n    height: PropTypes.number,\n    sensitive: PropTypes.bool,\n    revealed: PropTypes.bool,\n    startTime: PropTypes.number,\n    onOpenVideo: PropTypes.func,\n    onCloseVideo: PropTypes.func,\n    letterbox: PropTypes.bool,\n    fullwidth: PropTypes.bool,\n    detailed: PropTypes.bool,\n    inline: PropTypes.bool,\n    intl: PropTypes.object.isRequired,\n  };\n\n  state = {\n    currentTime: 0,\n    duration: 0,\n    paused: true,\n    dragging: false,\n    containerWidth: false,\n    fullscreen: false,\n    hovered: false,\n    muted: false,\n    revealed: this.props.revealed === undefined ? (!this.props.sensitive || displaySensitiveMedia) : this.props.revealed,\n  };\n\n  setPlayerRef = c => {\n    this.player = c;\n\n    if (c) {\n      this.setState({\n        containerWidth: c.offsetWidth,\n      });\n    }\n  }\n\n  setVideoRef = c => {\n    this.video = c;\n  }\n\n  setSeekRef = c => {\n    this.seek = c;\n  }\n\n  handleClickRoot = e => e.stopPropagation();\n\n  handlePlay = () => {\n    this.setState({ paused: false });\n  }\n\n  handlePause = () => {\n    this.setState({ paused: true });\n  }\n\n  handleTimeUpdate = () => {\n    this.setState({\n      currentTime: Math.floor(this.video.currentTime),\n      duration: Math.floor(this.video.duration),\n    });\n  }\n\n  handleMouseDown = e => {\n    document.addEventListener('mousemove', this.handleMouseMove, true);\n    document.addEventListener('mouseup', this.handleMouseUp, true);\n    document.addEventListener('touchmove', this.handleMouseMove, true);\n    document.addEventListener('touchend', this.handleMouseUp, true);\n\n    this.setState({ dragging: true });\n    this.video.pause();\n    this.handleMouseMove(e);\n  }\n\n  handleMouseUp = () => {\n    document.removeEventListener('mousemove', this.handleMouseMove, true);\n    document.removeEventListener('mouseup', this.handleMouseUp, true);\n    document.removeEventListener('touchmove', this.handleMouseMove, true);\n    document.removeEventListener('touchend', this.handleMouseUp, true);\n\n    this.setState({ dragging: false });\n    this.video.play();\n  }\n\n  handleMouseMove = throttle(e => {\n    const { x } = getPointerPosition(this.seek, e);\n    const currentTime = Math.floor(this.video.duration * x);\n\n    this.video.currentTime = currentTime;\n    this.setState({ currentTime });\n  }, 60);\n\n  togglePlay = () => {\n    if (this.state.paused) {\n      this.video.play();\n    } else {\n      this.video.pause();\n    }\n  }\n\n  toggleFullscreen = () => {\n    if (isFullscreen()) {\n      exitFullscreen();\n    } else {\n      requestFullscreen(this.player);\n    }\n  }\n\n  componentDidMount () {\n    document.addEventListener('fullscreenchange', this.handleFullscreenChange, true);\n    document.addEventListener('webkitfullscreenchange', this.handleFullscreenChange, true);\n    document.addEventListener('mozfullscreenchange', this.handleFullscreenChange, true);\n    document.addEventListener('MSFullscreenChange', this.handleFullscreenChange, true);\n  }\n\n  componentWillUnmount () {\n    document.removeEventListener('fullscreenchange', this.handleFullscreenChange, true);\n    document.removeEventListener('webkitfullscreenchange', this.handleFullscreenChange, true);\n    document.removeEventListener('mozfullscreenchange', this.handleFullscreenChange, true);\n    document.removeEventListener('MSFullscreenChange', this.handleFullscreenChange, true);\n  }\n\n  handleFullscreenChange = () => {\n    this.setState({ fullscreen: isFullscreen() });\n  }\n\n  handleMouseEnter = () => {\n    this.setState({ hovered: true });\n  }\n\n  handleMouseLeave = () => {\n    this.setState({ hovered: false });\n  }\n\n  toggleMute = () => {\n    this.video.muted = !this.video.muted;\n    this.setState({ muted: this.video.muted });\n  }\n\n  toggleReveal = () => {\n    if (this.state.revealed) {\n      this.video.pause();\n    }\n\n    this.setState({ revealed: !this.state.revealed });\n  }\n\n  handleLoadedData = () => {\n    if (this.props.startTime) {\n      this.video.currentTime = this.props.startTime;\n      this.video.play();\n    }\n  }\n\n  handleProgress = () => {\n    if (this.video.buffered.length > 0) {\n      this.setState({ buffer: this.video.buffered.end(0) / this.video.duration * 100 });\n    }\n  }\n\n  handleOpenVideo = () => {\n    const { src, preview, width, height } = this.props;\n    const media = fromJS({\n      type: 'video',\n      url: src,\n      preview_url: preview,\n      width,\n      height,\n    });\n\n    this.video.pause();\n    this.props.onOpenVideo(media, this.video.currentTime);\n  }\n\n  handleCloseVideo = () => {\n    this.video.pause();\n    this.props.onCloseVideo();\n  }\n\n  render () {\n    const { preview, src, inline, startTime, onOpenVideo, onCloseVideo, intl, alt, letterbox, fullwidth, detailed, sensitive } = this.props;\n    const { containerWidth, currentTime, duration, buffer, dragging, paused, fullscreen, hovered, muted, revealed } = this.state;\n    const progress = (currentTime / duration) * 100;\n    const playerStyle = {};\n\n    let { width, height } = this.props;\n\n    if (inline && containerWidth) {\n      width  = containerWidth;\n      height = containerWidth / (16/9);\n\n      playerStyle.width  = width;\n      playerStyle.height = height;\n    }\n\n    let warning;\n    if (sensitive) {\n      warning = <FormattedMessage id='status.sensitive_warning' defaultMessage='Sensitive content' />;\n    } else {\n      warning = <FormattedMessage id='status.media_hidden' defaultMessage='Media hidden' />;\n    }\n\n    return (\n      <div\n        className={classNames('video-player', { inactive: !revealed, detailed, inline: inline && !fullscreen, fullscreen, letterbox, 'full-width': fullwidth })}\n        style={playerStyle}\n        ref={this.setPlayerRef}\n        onMouseEnter={this.handleMouseEnter}\n        onMouseLeave={this.handleMouseLeave}\n        onClick={this.handleClickRoot}\n        tabIndex={0}\n      >\n        <video\n          ref={this.setVideoRef}\n          src={src}\n          poster={preview}\n          preload={startTime ? 'auto' : 'none'}\n          loop\n          role='button'\n          tabIndex='0'\n          aria-label={alt}\n          width={width}\n          height={height}\n          onClick={this.togglePlay}\n          onPlay={this.handlePlay}\n          onPause={this.handlePause}\n          onTimeUpdate={this.handleTimeUpdate}\n          onLoadedData={this.handleLoadedData}\n          onProgress={this.handleProgress}\n        />\n\n        <button type='button' className={classNames('video-player__spoiler', { active: !revealed })} onClick={this.toggleReveal}>\n          <span className='video-player__spoiler__title'>{warning}</span>\n          <span className='video-player__spoiler__subtitle'><FormattedMessage id='status.sensitive_toggle' defaultMessage='Click to view' /></span>\n        </button>\n\n        <div className={classNames('video-player__controls', { active: paused || hovered })}>\n          <div className='video-player__seek' onMouseDown={this.handleMouseDown} ref={this.setSeekRef}>\n            <div className='video-player__seek__buffer' style={{ width: `${buffer}%` }} />\n            <div className='video-player__seek__progress' style={{ width: `${progress}%` }} />\n\n            <span\n              className={classNames('video-player__seek__handle', { active: dragging })}\n              tabIndex='0'\n              style={{ left: `${progress}%` }}\n            />\n          </div>\n\n          <div className='video-player__buttons-bar'>\n            <div className='video-player__buttons left'>\n              <button type='button' aria-label={intl.formatMessage(paused ? messages.play : messages.pause)} onClick={this.togglePlay}><i className={classNames('fa fa-fw', { 'fa-play': paused, 'fa-pause': !paused })} /></button>\n              <button type='button' aria-label={intl.formatMessage(muted ? messages.unmute : messages.mute)} onClick={this.toggleMute}><i className={classNames('fa fa-fw', { 'fa-volume-off': muted, 'fa-volume-up': !muted })} /></button>\n\n              {!onCloseVideo && <button type='button' aria-label={intl.formatMessage(messages.hide)} onClick={this.toggleReveal}><i className='fa fa-fw fa-eye' /></button>}\n\n              {(detailed || fullscreen) &&\n                <span>\n                  <span className='video-player__time-current'>{formatTime(currentTime)}</span>\n                  <span className='video-player__time-sep'>/</span>\n                  <span className='video-player__time-total'>{formatTime(duration)}</span>\n                </span>\n              }\n            </div>\n\n            <div className='video-player__buttons right'>\n              {(!fullscreen && onOpenVideo) && <button type='button' aria-label={intl.formatMessage(messages.expand)} onClick={this.handleOpenVideo}><i className='fa fa-fw fa-expand' /></button>}\n              {onCloseVideo && <button type='button' aria-label={intl.formatMessage(messages.close)} onClick={this.handleCloseVideo}><i className='fa fa-fw fa-compress' /></button>}\n              <button type='button' aria-label={intl.formatMessage(fullscreen ? messages.exit_fullscreen : messages.fullscreen)} onClick={this.toggleFullscreen}><i className={classNames('fa fa-fw', { 'fa-arrows-alt': !fullscreen, 'fa-compress': fullscreen })} /></button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/mnt/gentoo/home/haelwenn/Sources/git/hacktivis.me/git/mastofe/app/javascript/flavours/glitch/features/video/index.js"],"sourceRoot":""}