webpackJsonp([69],{846:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i.d(t,"default",function(){return P});var a,n,s,l,o,r=i(1),d=i.n(r),p=i(2),c=i.n(p),u=i(3),g=i.n(u),h=i(4),v=i.n(h),m=i(0),f=i.n(m),y=i(6),b=(i.n(y),i(151)),_=i(7),x=i(403),k=i(10),w=i.n(k),C=i(53),M=Object(_.f)({hidden:{id:"status.media_hidden",defaultMessage:"Media hidden"},sensitive:{id:"media_gallery.sensitive",defaultMessage:"Sensitive"},toggle:{id:"status.sensitive_toggle",defaultMessage:"Click to view"},toggle_visible:{id:"media_gallery.toggle_visible",defaultMessage:"Toggle visibility"},warning:{id:"status.sensitive_warning",defaultMessage:"Sensitive content"}}),N=(n=a=function(e){function t(){var i,a,n;c()(this,t);for(var s=arguments.length,l=Array(s),o=0;o<s;o++)l[o]=arguments[o];return i=a=g()(this,e.call.apply(e,[this].concat(l))),a.handleMouseEnter=function(e){a.hoverToPlay()&&e.target.play()},a.handleMouseLeave=function(e){a.hoverToPlay()&&(e.target.pause(),e.target.currentTime=0)},a.handleClick=function(e){var t=a.props,i=t.index,n=t.onClick;0===e.button&&(e.preventDefault(),n(i)),e.stopPropagation()},n=i,g()(a,n)}return v()(t,e),t.prototype.hoverToPlay=function(){var e=this.props.attachment;return!C.a&&"gifv"===e.get("type")},t.prototype.render=function(){var e=this.props,t=e.attachment,i=e.index,a=e.size,n=e.standalone,s=e.letterbox,l=e.displayWidth,o=50,r=100,p="auto",c="auto",u="auto",g="auto";1===a&&(o=100),(4===a||3===a&&i>0)&&(r=50),2===a?0===i?g="2px":c="2px":3===a?(0===i?g="2px":i>0&&(c="2px"),1===i?u="2px":i>1&&(p="2px")):4===a&&(0!==i&&2!==i||(g="2px"),1!==i&&3!==i||(c="2px"),i<2?u="2px":p="2px");var h="";if("image"===t.get("type")){var v=t.get("preview_url"),m=t.getIn(["meta","small","width"]),f=t.get("url"),y=t.getIn(["meta","original","width"]),b="number"==typeof y&&"number"==typeof m,_=b?f+" "+y+"w, "+v+" "+m+"w":null,k=b?l*(o/100)+"px":null,M=t.getIn(["meta","focus","x"])||0,N=t.getIn(["meta","focus","y"])||0,P=100*(M/2+.5),E=100*(N/-2+.5);h=d()("a",{className:"media-gallery__item-thumbnail",href:t.get("remote_url")||f,onClick:this.handleClick,target:"_blank"},void 0,d()("img",{className:s?"letterbox":null,src:v,srcSet:_,sizes:k,alt:t.get("description"),title:t.get("description"),style:{objectPosition:P+"% "+E+"%"}}))}else if("gifv"===t.get("type")){var O=!Object(x.a)()&&C.a;h=d()("div",{className:w()("media-gallery__gifv",{autoplay:O})},void 0,d()("video",{className:"media-gallery__item-gifv-thumbnail"+(s?" letterbox":""),"aria-label":t.get("description"),role:"application",src:t.get("url"),onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,autoPlay:O,loop:!0,muted:!0}),d()("span",{className:"media-gallery__gifv__label"},void 0,"GIF"))}return d()("div",{className:w()("media-gallery__item",{standalone:n}),style:{left:c,top:p,right:g,bottom:u,width:o+"%",height:r+"%"}},t.get("id"),h)},t}(f.a.PureComponent),a.defaultProps={standalone:!1,index:0,size:1},n),P=Object(_.g)((o=l=function(e){function t(){var i,a,n;c()(this,t);for(var s=arguments.length,l=Array(s),o=0;o<s;o++)l[o]=arguments[o];return i=a=g()(this,e.call.apply(e,[this].concat(l))),a.state={visible:void 0===a.props.revealed?!a.props.sensitive||C.e:a.props.revealed},a.handleOpen=function(){a.setState({visible:!a.state.visible})},a.handleClick=function(e){a.props.onOpenMedia(a.props.media,e)},a.handleRef=function(e){e&&a.setState({width:e.offsetWidth})},n=i,g()(a,n)}return v()(t,e),t.prototype.componentWillReceiveProps=function(e){Object(y.is)(e.media,this.props.media)||this.setState({visible:!e.sensitive})},t.prototype.isStandaloneEligible=function(){var e=this.props,t=e.media;return e.standalone&&1===t.size&&t.getIn([0,"meta","small","aspect"])},t.prototype.render=function(){var e=this,t=this.props,i=t.media,a=t.intl,n=t.sensitive,s=t.letterbox,l=t.fullwidth,o=this.state,r=o.width,p=o.visible,c=i.take(4).size,u=void 0,g={};if(this.isStandaloneEligible()&&r&&(g.height=r/this.props.media.getIn([0,"meta","small","aspect"])),p)u=this.isStandaloneEligible()?d()(N,{standalone:!0,attachment:i.get(0),onClick:this.handleClick,displayWidth:r}):i.take(4).map(function(t,i){return d()(N,{onClick:e.handleClick,attachment:t,index:i,size:c,letterbox:s,displayWidth:r},t.get("id"))});else{var h=f.a.createElement(_.b,n?M.warning:M.hidden);u=d()("button",{className:"media-spoiler",type:"button",onClick:this.handleOpen},void 0,d()("span",{className:"media-spoiler__warning"},void 0,h),d()("span",{className:"media-spoiler__trigger"},void 0,f.a.createElement(_.b,M.toggle)))}var v=w()("media-gallery","size-"+c,{"full-width":l});return f.a.createElement("div",{className:v,style:g,ref:this.handleRef},p?d()("div",{className:"sensitive-info"},void 0,d()(b.a,{icon:"eye",onClick:this.handleOpen,overlay:!0,title:a.formatMessage(M.toggle_visible)}),n?d()("span",{className:"sensitive-marker"},void 0,f.a.createElement(_.b,M.sensitive)):null):null,u)},t}(f.a.PureComponent),l.defaultProps={standalone:!1},s=o))||s}});
//# sourceMappingURL=media_gallery.js.map